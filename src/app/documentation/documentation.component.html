<!-- karo -->
<div class="container">
    <img   src="assets/image.png" alt="image">
    <div class="text-container">
        <div id="top">
            <h1>Documentation</h1>
            <p>This documentation provides an overview of the project, including setup instructions and usage details. For more information, we refer to our publication: </p>
            <br>
            <span class="title-reference">
                TOXTRUST: a tool leveraging the Dempster-Shafer Theory for robust integration of NAM results in decision-making considering uncertainty
            </span> 
            <br>
            <span class="names">
                Karolina Kopańska, Adrian Cabrera, Manuel Pastor
            </span>
            <br>
            <span class="date-reference"> <span class="subtitle-reference">TBD </span>(2025): volume TBD </span>
            <br>
             <span>DOI:  <a target=”_blank” href="https:..." class="timestamp">TBD</a></span>
             <br>
             <br>

            <h2>Table of Contents</h2>
            <ul class="no-bullets">
                <li><a href="#introduction" class="timestamp">1. Introduction</a></li>
                <li><a href="#dst" class="timestamp">2. Dempster-Shafer Theory</a></li>
                <li><a href="#framework" class="timestamp">3. Choosing an appropriate framework</a></li>
                <li><a href="#evidence" class="timestamp">4. Independence of evidence</a></li>
                <li><a href="#toxtrust" class="timestamp">5. Methodological integration into TOXTRUST</a></li>
                <li><a href="#interface" class="timestamp">6.	TOXTRUST user interface</a></li>
            </ul>
        
            <h2 id="introduction">1. Introduction</h2>
            <p>Decisions form a central element of chemical risk assessment. While
                the traditional strategies to probability are very commonly applied in
                decision analysis, there are several alternatives 
                    <a href="https://www.tandfonline.com/doi/abs/10.1080/03081079.2010.506179" class="plain-link" target="_blank" rel="noopener noreferrer">(Dubois and Guyonnet,
                    2011)</a>. Among all mathematical approaches that allow considering
                several lines of partially uncertain evidence to come to a decision,
                the Dempster-Shafer Theory (DST) is the one with the highest degree
                of theoretical development 
                    <a href="https://www.osti.gov/servlets/purl/800792/" class="plain-link" target="_blank" rel="noopener noreferrer">(Sentz and Ferson, 2002</a>
                    ;
                    <a href="https://www.sciencedirect.com/science/article/pii/S0888613X16301141?via%3Dihub" class="plain-link" target="_blank" rel="noopener noreferrer">Shafer, 2016)</a>.
            </p>

                
            <p><a href="#top" class="timestamp">Back to top</a></p>
        
            <h2 id="dst">2. Dempster-Shafer Theory</h2>
            <p>
            
            The Dempster-Shafer Theory evolved from the work of Arthur P.
            Dempster (Dempster, <a href="https://www.jstor.org/stable/2239146?seq=1" class="plain-link" target="_blank" rel="noopener noreferrer">1967; </a> <a href="https://www.jstor.org/stable/2984504?seq=1" class="plain-link" target="_blank" rel="noopener noreferrer">1968)</a> and was further developed and described
            by Glenn Shafer as A mathematical theory of evidence <a href="https://doi.org/10.2307/j.ctv10vm1qb" class="plain-link" target="_blank" rel="noopener noreferrer">(Shafer, 1976)</a>, alternatively referred to as the Theory of Belief Functions. As
            introduced by Dempster, the DST generalises the classical Bayesian
            inference by offering a trade-off between advantages and disadvantages.
            </p>
            <br>
            <p>
            In its ingenuous form, the Bayesian theorem requires priors that are
            directly linked to the toxicological question asked. However, it ignores
            the reliability of the sources from which the priors are derived.
            As a consequence, the associated uncertainty is estimated mainly as a
            function of the initial beliefs, whose actual quality is unknown. Sometimes
            such prior probabilities may not be available, or they may be
            conflicting 
            <a href="https://www.intechopen.com/chapters/69160" class="plain-link" target="_blank" rel="noopener noreferrer">(Ghaderinezhad et al., 2019</a>
            ;
            <a href="https://link.springer.com/article/10.1007/s12561-010-9018-x" class="plain-link" target="_blank" rel="noopener noreferrer">Morita et al., 2010)</a>
            , making the application of Bayesian inference difficult or impossible. Within
            the DST framework, instead of referring directly to the toxicological
            question, the assignment of probabilities is carried out using subjective
            probabilities for a related question <a href="https://www.sciencedirect.com/science/article/abs/pii/B9780444700582500140?via%3Dihub" class="plain-link" target="_blank" rel="noopener noreferrer">(Shafer, 1986)</a>. This question
            can either refer to the expertise of the individual making a judgement
            or the performance of the experimental or computational procedure
            producing a toxicological result.
            </p>
            <br>
            <p>
            By contrast with Bayesian statistics which draws upon a single evidence
            piece to estimate the probability of an outcome, the DST can
            combine multiple pieces of evidence to provide such estimates. Within
            the DST framework, probabilities that are assigned to single evidence
            pieces constitute separate inputs for combination rules; a special type
            of aggregation method for data obtained from independent sources
            of information of different quality <a href="https://www.sciencedirect.com/science/article/abs/pii/B9780444700582500140?via%3Dihub" class="plain-link" target="_blank" rel="noopener noreferrer">(Shafer, 1986)</a>. Dempster’s rule,
            Yager’s modified Dempster’s rule, and Inagaki’s unified combination
            rule are the key combination rules that contributed to the establishment
            of the mathematical basis of the DST. These rules differ from
            each other in terms of decision rigorousness, methods for estimating
            uncertainty, and conflict handling. A comprehensive description of
            these differences was provided by <a href="https://www.osti.gov/servlets/purl/800792/" class="plain-link" target="_blank" rel="noopener noreferrer">Sentz and Ferson (2002)</a> and <a href="https://www.sciencedirect.com/science/article/pii/S1877050913002755?via%3Dihub" class="plain-link" target="_blank" rel="noopener noreferrer">Lepskiya (2013)</a>. Novel literature offers insights into many other combination
            rules that build on them.
            </p>
            <br>
            <p>
            As an advantage for decision-making, the DST provides a flexible and
            robust framework for reasoning with epistemic uncertainty, allowing
            to computing of lower and upper bounds of probability for scientific
            questions using independent evidence pieces or the combination
            thereof. The bounded representation ranges between the degrees of
            Belief and Plausibility, representing the probabilities that correspond
            with the full and the maximum confidence that can be attributed to a
            specific answer to a given question <a href="https://www.jstor.org/stable/2239146?seq=1" class="plain-link" target="_blank" rel="noopener noreferrer">(Dempster, 1967)</a>.
            </p>
            <br>
            <p>
            Although not yet in widespread use among toxicologists and risk assessors,
            the DST has already been referenced as a promising method
            with the potential to bridge probabilistic reasoning with toxicological
            decision-making <a href="https://link.springer.com/article/10.1007/s00204-020-02866-4" class="plain-link" target="_blank" rel="noopener noreferrer">(Moné et al., 2020)</a>. In practice, <a href="https://pubmed.ncbi.nlm.nih.gov/23804574/" class="plain-link" target="_blank" rel="noopener noreferrer">Park et al. (2014)</a>
            described the application of the DST for combining risk estimates derived
            from scientific conclusions and <a href="https://www.sciencedirect.com/science/article/abs/pii/S2468111318300197?via%3Dihub" class="plain-link" target="_blank" rel="noopener noreferrer">Rathman et al. (2018)</a> described
            its use for combining in silico predictions.
            </p>
            
            <p><a href="#top" class="timestamp">Back to top</a></p>
        
            <h2 id="framework">3. Choosing an appropriate framework</h2>

            <p>
            The consideration of uncertainty is essential when
            several results, generated using different methods of diverse quality,
            are combined to answer a specific toxicological question. Ideally, relevant
            pieces of evidence should be translated into a single answer
            applying an appropriate probabilistic or mathematical method. However,
            there is no unique way to express the uncertainties associated
            with the single evidence pieces as well as with their combination. The
            selection of the best strategy should be guided by the type of the problem
            and the characteristics of the available evidence. While classical
            Frequentists and Bayesian methods represent the predominant choice
            to address majority of toxicological problems, the application of alternative
            frameworks such as the Dempster-Shafer Theory might sometimes
            be more appropriate.
            </p>
            <br>
            <p>
            Among the arguments in favour of the DST is the possibility to represent
            partly uncertain or incomplete information without providing
            precise prior information on the evidence. Instead, the flexible DST
            framework derives probabilities for all possible answers to a question,
            including the answer "I don’t know", by merging the results generated by the given sources of evidence with the information on their
            reliability. Also, there is a relative simplicity behind the integration
            of evidence pieces from different sources to a mathematically valid
            result, which is an important precondition for the application of complex
            mathematical methods in toxicological praxis. The DST can also
            be seen as a decision system that objectively analyses the strength of
            provided evidence pieces and points to the most probable outcome.
            This capacity to support decision-making under the consideration of
            uncertainty or facing conflicting evidence can greatly benefit various
            types of toxicological assessments.
            </p>
            <br>
            <p>
            Regarding its limitations, first and foremost, if multiple evidence
            pieces are to be combined, they must be connected through the same
            question. With other words, the DST cannot be applied in situations
            in which the considered sources of evidence generate data covering
            different areas of the endpoint’s biological space. Second, the independence
            between different evidence elements referring to the same
            toxicological question may not always be guaranteed. Third, the unavailability
            of computational tools simplifying the implementation of
            the DST limits its application for toxicological risk assessments.
            </p>

            <p><a href="#top" class="timestamp">Back to top</a></p>

            <h2 id="evidence">4. Independence of evidence</h2>
            <p>
            The aspect of independence, consisting of three main conditions, is fundamental to ensure the mathematical validity of combination results produced using the DST framework. For a comprehensive mathematical description of the most relevant concepts, we refer to the article by <a href="https://www.sciencedirect.com/science/article/pii/S0888613X10000447?via%3Dihub
            " class="plain-link" target="_blank" rel="noopener noreferrer">Couso and Moral (2010)</a>. 
            </p>
            <br>
            <p>
            
            The first condition requires that the occurrence of any considered event is independent of the occurrence of another considered event. In the context of the NGRA, the statistical term “event” can be interpreted as the result produced by a NAM. Under this definition, the first condition of independence is fulfilled when the result generated by the given NAM does not depend on or affect the result produced by another NAM. Adverse Outcome Pathways (AOPs), for instance, generally fail to fulfil this requirement since the occurrence of Key Events inevitably depends on the occurrence of the Molecular Initiating Event. Consequently, the DST does not provide appropriate methods to combine probabilities collected for different events along the AOP. 

            </p>
            <br>
            <p>

            The second condition refers to the methodology and implies that the NAMs that generate separate evidence pieces meant to be combined for the same endpoint are independent. This condition is automatically met when the testing methods are of different types, for instance, in vitro and in silico. However, in cases when the same method is applied twice, some additional criteria must be fulfilled. To give an example, we propose considering two QSAR models as independent if their training series do not share compounds, and the molecular descriptors and/or the machine-learning algorithms are sufficiently different. 

            </p>
            <br>
            <p>

            The third condition imposes that the procedures involved in selecting different evidence pieces are independent. Simply put, when a NAM generates a negative result, we cannot adjust the testing pipeline and “cherry-pick” a particular NAM, from which we expect the highest probability of generating a second negative result.
            </p>

        
            <h2 id="toxtrust">5. Methodological integration into TOXTRUST</h2>
            <p>
            TOXTRUST is an open-source Python-based tool specifically designed to support the practical application of the
             DST formalism to toxicological questions. TOXTRUST allows
            translating computational and experimental results into objective decisions
            and provides a rigorous way to consider the epistemic uncertainty.
            The proposed approach is not endpoint-specific and can be
            applied to communicate the degrees of belief and plausibility for single
            elements of toxicological evidence and to combine toxicological
            results to a single hazard estimate expressed by means of probability
            bounds.
            </p>
            <br>
            <p>

            Functionally, TOXTRUST is divided into three modules responsible for handling individual pieces of toxicological evidence, combining them, and making decisions based on the computed probabilistic results. All three modules can be seen as sub-systems that bundle data and functionality together, operated through an “umbrella system” called endpoint (endpoints are directly liked with projects). 
            </p>

            <h3> 5.1. Endpoint</h3>
            <p>
            The endpoint class serves as the central component that enables and regulates the use of implemented features, ensuring the mathematical accuracy of the results. This class gathers input from the user, processes it by initialising other relevant classes or functions, and securely stores the data through local file permanence. Each operation is accompanied by a message informing the user of its success or failure. 
            </p>
            <h3> 5.2. Single evidence</h3>
            <p>

            This class gathers and processes information that describes the result and the method used to produce it. Required variables include identifier, source, result, and reliability. Relevance and weight are optional variables that enhance the informational value of the evidence.
            </p>
            <p>
            Each piece of evidence is assigned an identifier and classified into one of four source categories: 
            </p>
            <ul>
                <li><i>“In silico”</i></li>
                <li><i>“In vitro”</i></li>
                <li><i>“Expert”</i></li>
                <li><i>“Alert”</i></li>
                <li><i>“Read-across”</i></li>
            </ul>
            <p>
            Results can be expressed in two ways, either as binary labels (0 or 1) or as probability values within the range [0, 1].
            </p>

            <p>
            Reliability quantifies the performance of the body of evidence in producing the result. The tool supports a wide range of quantitative reliability metrics input as verbal prompts, ensuring maximum flexibility. Specificity and sensitivity are common measures for assessing toxicological methods. Whenever possible, it is recommended to consider prior information and update such scores to positive predictive values and negative predictive values <a href="https://www.jclinepi.com/article/S0895-4356(20)31225-7/fulltext" class="plain-link" target="_blank" rel="noopener noreferrer">(Bours 2021)</a>. Conversely, if the available data is relatively poor, more general measures such as accuracy can also be considered. Expert judgment can be considered as an alternative when statistical reliability metrics are unavailable.            
            </p>

            <p>
            Relevance assesses the appropriateness of an evidence piece for answering the assessment question. The distinction between reliability and relevance in toxicity assessments is outlined by <a href="https://www.sciencedirect.com/science/article/abs/pii/S2468111321000505?via%3Dihub" class="plain-link" target="_blank" rel="noopener noreferrer">Johnson et al. (2021)</a>. In TOXTRUST, relevance scores are offered as a dictionary of terms with corresponding numerical values:
            </p>
            <ul>
                <li><i>Certain: 1</i></li>
                <li><i>Probable: 0.9</i></li>
                <li><i>Plausible: 0.75</i></li>
                <li><i>Equivocal: 0.5</i></li>
                <li><i>Doubted: 0.25</i></li>
                <li><i>Improbable: 0.1</i></li>
                <li><i>Impossible: 0</i></li>   
            </ul>
            <p>
            Certain is the default score. However, adjustments may be made in cases when downgrading the relevance is necessary to better characterise the result.  For example, an in vitro test might demonstrate high specificity, yet its negative result might still be ambiguous. By adjusting relevance, the new score is merged with the result and reliability during the computation of basic probability masses.
            </p>

            <p>
            The weight variable can be used to apply the "weight of evidence" concept, allowing to rank the relative importance of evidence pieces among each other. The default weight is 1, which can be replaced by any other integral number not larger than 5.
            </p>

            <p>
            For each piece of evidence, the class computes basic probability masses for the three elements of the power set: “Negative”, “Uncertain”, and “Positive”. These results are displayed in a tabular format. In addition, the degrees of Belief and Plausibility are also computed and stored for further analysis and visualisation. 
            </p>

            <h3> 5.3.	Evidence combination</h3>

            <p>
            The combination class serves to integrate the individually added evidence pieces using different DST-based rules and to visualise the final result. A set of inputs and user-defined settings is required to initialise this class. The most critical input is the list of evidence pieces, which must be pre-stored in the file system. Users should enable the "weight of evidence" option if weights were previously modified for the selected evidence pieces.
            </p>

            <p>
            Next, the users can select one of three combination rules (Dempster’s, Yager’s, and Inagaki’s rule). For Inagaki’s rule, the scaling factor c can additionally be specified. To simplify this selection, numeric values for the scaling factor are accompanied by descriptive labels:
            </p>
            <ul>
                <li><i>Full decision: 1</i></li>
                <li><i>Partial decision: 0.75</i></li>
                <li><i>Balance: 0.5</i></li>
                <li><i>Partial uncertainty: 0.75</i></li>
                <li><i>Full uncertainty: 0</i></li>
            </ul>

            <p>
            The default label for c is balance: 0.5.
            </p>
            <p>
            If users are unsure about the appropriate combination rule, TOXTRUST provides an “auto” rule-selection option. More specifically, the auto rule-selection function first examines whether the uncertainty level of any individual evidence piece exceeds the user-defined uncertainty threshold. If this condition is met, Yager’s rule is selected. If not, the function evaluates the agreement between the evidence pieces using an internal TOXTRUST variable called maximum acceptable conflict. This variable is calculated separately for each evidence piece by summing the probability masses for the two possible outcomes (“Negative” and “Positive”) and dividing the sum by 2. If the maximum acceptable conflict is not exceeded, Dempster’s rule is chosen. Otherwise, Inagaki’s rule is applied, with the default scaling factor c used unless the user specifies a different value. This logic can be summarised as follows:
            </p>
            <ol class="nums">
                <li><i>Yager’s rule</i>: if any evidence piece exceeds the defined uncertainty threshold</li>
                <li><i>Dempster’s rule</i>: when all evidence sources agree</li>
                <li><i>Inagaki’s rule</i>: in cases of significant conflict between evidence sources, with the default factor c</li>
            </ol>

            <p>
            Whether the evidence combination is manual or automatic, the class computes joint basic probability masses for the three elements of the power set: “Negative”, “Uncertain”, and “Positive”.
            </p>
            <p>
            These results are displayed in a tabular format and visualised through an interactive diagram, which provides an intuitive representation of the computed probabilities. Additionally, the degrees of Belief and Plausibility for the combined evidence are automatically calculated and stored with the results for further analysis
            </p>

            <h3> 5.3.	Decision maker</h3>
            <p>
            The decision maker feature in TOXTRUST assists users in making objective decisions by incorporating settings defined before evidence collection or combination. These settings specify the maximum allowed level of uncertainty (uncertainty threshold) associated with a specific outcome and the minimum required level of Belief (confidence threshold) in that outcome.
            </p>
            <p>
            When applying the decision maker to a particular evidence piece, the function first examines whether the uncertainty threshold is not exceeded. If this condition is not fulfilled, the decision falls on the “Uncertain” element. In an opposite case, the analysis is complemented by comparing the degrees of Belief for both possible outcomes (“Negative” and “Positive) against the confidence threshold. The final decision falls on the outcome lying above the confidence threshold.
            </p>
            <p>
            The decision maker feature is designed to operate flexibly for both classes, single evidence and evidence combination. The resulting decisions can be presented either as verbal outputs, pointing to one of the three possible options (“Negative”, “Uncertain”, or “Positive”) or through error diagrams, which visually depict the bounds of Belief and Plausibility.
            </p>



            <h2 id="interface">6.	TOXTRUST user interface</h2>

            <p>
                The GUI of TOXTRUST is designed to run on any computer on a local server, accessible through the browser at a host address (http://localhost:5000) — visible in the top search bar. The interactive drop-down menu in the upper left corne provides the essential functions, including creating new projects, accessing existing projects, viewing documentation, navigating to the code repository, and consulting references. The design, with the colourful graphic at the top and the white placeholder space for user input, is uniformly applied across all sections of TOXTRUST.
                </p>
                <br>
                <p>
    
                Projects  in TOXTRUST are managed through file permanence and can be accessed anytime from the main menu, regardless of their stage of advancement. Each time a new project is created, TOXTRUST generates a subfolder in the local file system to store all associated data, ensuring its availability for later retrieval. The Existing projects tab displays a table listing the general information about the endpoints collected in Step 1, including the endpoint name, compound, testing framework, and project permissions. Projects can be easily removed by clicking the Delete button.
                </p>


            <h3> 6.1. New project</h3>
            <p>
            Creating a new project in TOXTRUST is straightforward. After selecting the corresponding option from the main menu, a new window appears, prompting the user to provide a name for the project (e.g., Mechanism X). In TOXTRUST, all blue buttons symbolise additional functions or features. When a new project is created, the tool creates a placeholder to ensure file permanence for that project, which the interface automatically advances to the next step. 
            </p>
            <h3> 6.2. Endpoint </h3>
            <p>
            Each project in TOXTRUST is organised into four consecutive steps, which are displayed at the top of the dialogue. The first step involves providing general information about the endpoint, such as the name of the compound, testing framework, a description of the assessment question, and project permissions reflecting its confidentiality status. Once the required information is entered, it can be saved. 
            </p>
            <h3> 6.3.	Settings </h3>
            <p>
            The second project step requires the user to specify their preferences to guide decision-making and evidence combination. In the Decision Settings section, users must define both the maximum allowable level of uncertainty and the minimum required level of belief. These are the uncertainty and confidence thresholds, respectively. In the Combination Settings section, users can either manually select a rule or tick the “Auto rule selection” option. If the latter is chosen, the tool disables further rule settings, as they become irrelevant. At this stage, users can also decide whether to combine evidence following the weight of evidence concept.
            </p>

            <h3> 6.4.	Evidence </h3>
            <p>
            In the third project step, evidence pieces are collected. The “Add evidence” dialogue displays all required (identifier, source, result, reliability) and optional variables (relevance, weight). In the result section, users can tick either one of the outcomes (“Negative” or “Positive”) or both.
        </p>
            <ul>
                <li>If only one outcome is selected (e.g., to indicate a result of an in vitro experiment), probability values are not required.</li>
                <li>If both outcomes are selected (e.g., to consider predicted probabilities from in silico models), the probability box becomes mandatory, and the sum of the provided probabilities must equal 1.</li>
            </ul>

            <p>
            The reliability dialogue is directly linked with the result section. Here, users can specify the metric verbally and add the corresponding value.
            </p>
            <br>
            <p>
            Once a new evidence piece is saved, the data provided by the user—along with the computed probabilities for all possible outcomes (“Negative”, “Uncertain”, “Positive”) and the decision. Additional features include a Combine column for selecting evidence pieces for combination and a Delete column for easy removal of individual entries.
            </p>
            <br>
            <p>

            Clicking on the blue-marked outcome (e.g., “Negative”) in the Decision column opens an additional window divided into two sections. The upper section displays a table with the computed bounds for the degrees of Belief and Plausibility for the outcomes “Negative” and “Positive”. The lower section contains a plot showing probability bounds only for outcomes with non-zero results. The function of the latter is to visually inform users about the level of uncertainty associated with the given evidence piece and provide a foundation explaining the decision made.
            </p>
            <h3> 6.5	Combination </h3>
            <p>

            After selecting evidence pieces in Step 3 and clicking the Combine button, the data are integrated considering the settings submitted in Step 2. As for single evidence, also for their combination, the relevant data, the computed probabilities for all possible outcomes (“Negative”, “Uncertain”, “Positive”) and the decision are shown in a table. Regarding the relevant data, they cover the endpoint name, the list of combined single evidence pieces, and the combination rule. The combination result can be easily removed by clicking the Delete button. 
        </p>
            <p><a href="#top" class="timestamp">Back to top</a></p>


        </div>

    </div>
</div>

<style>

    h2 {
        font-size: 26px;  /* Reduced from 24px to 18px */
        /*color: #007bff;*/
        /*margin-top: 15px;*/
    }

    h3 {
        font-size: 19px;  /* Reduced from 24px to 18px 
        color: #007bff;*/
        margin-left: 35px;
        font-style: bold;
    }

    /*ul {
        list-style-type: none;
        padding: 0;
    }*/

    ul li {
        margin: 5px 0;

    }

    ul li a:hover {
        text-decoration: underline;
    }

    ol li {
        margin: 5px 0;

    }

    ol li a:hover {
        text-decoration: underline;
    }

    .no-bullets {
        list-style-type: none; /* Removes the bullets */
        padding-left: 0; /* Removes any indentation */

    }

    html {
        scroll-behavior: smooth;
    }
</style>